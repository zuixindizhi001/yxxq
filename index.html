<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>映像星球-永久发布页</title>
    <link href="css/normalize.css" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/opposans" rel="stylesheet">
    
    <!-- 更换为更稳定的 CDN 链接 -->
    <script src="https://cdn.staticfile.org/clipboard.js/2.0.11/clipboard.min.js"></script>

    <style>
        :root { --bg-color: #0b0e21; --primary-purple: #7056ff; --text-dim: #a0a5ba; }
        body { background-color: var(--bg-color); background-image: radial-gradient(circle at top, #1e254d 0%, #0b0e21 100%); font-family: 'Opposans', sans-serif; color: #fff; margin: 0; padding: 0; min-height: 100vh; }
        .container { max-width: 500px; margin: 0 auto; padding: 15px; display: flex; flex-direction: column; align-items: center; }
        
        /* 顶部窄条样式 */
        .top-notice-bar { background: rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 10px 20px; font-size: 13px; color: #fff; text-align: center; margin: 15px 0; cursor: pointer; width: 90%; border: 1px solid rgba(255,255,255,0.1); }
        .top-notice-bar b { color: #ffc107; text-decoration: underline; }

        /* Logo */
        .header { margin: 20px 0; }
        .header img { width: 180px; height: auto; }

        /* 永久域名大卡片 */
        .permanent-card { background: rgba(30, 35, 70, 0.7); border: 1px solid rgba(112, 86, 255, 0.4); border-radius: 20px; width: 100%; padding: 25px 0; text-align: center; margin-bottom: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.4); }
        .permanent-card .hint { font-size: 14px; opacity: 0.8; margin-bottom: 8px; }
        .permanent-card .domain-name { font-size: 38px; font-weight: bold; margin-bottom: 20px; text-shadow: 0 0 15px rgba(112, 86, 255, 0.6); }
        .btn-main { background: var(--primary-purple); color: white; border: none; padding: 10px 35px; border-radius: 25px; font-size: 15px; cursor: pointer; transition: 0.3s; }

        /* 域名列表 */
        .domain-list { width: 100%; background: rgba(255, 255, 255, 0.05); border-radius: 15px; overflow: hidden; }
        .domain-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 18px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        .domain-info .label { font-size: 12px; color: var(--text-dim); margin-bottom: 3px; }
        .domain-info .url { font-size: 14px; color: #fff; }
        .actions { display: flex; align-items: center; gap: 8px; }
        .speed { font-size: 11px; font-weight: bold; min-width: 40px; text-align: right; }
        .speed.good { color: #00ff88; }
        .speed.bad { color: #ff4444; }
        .btn-sm { padding: 6px 12px; border-radius: 6px; font-size: 12px; text-decoration: none; color: #fff; background: rgba(255, 255, 255, 0.1); }
        .btn-sm.enter { background: var(--primary-purple); }

        /* 二维码 */
        .qr-section { margin-top: 30px; text-align: center; }
        .qr-section img { width: 130px; height: 130px; padding: 8px; background: #fff; border-radius: 10px; }
        .qr-section p { color: var(--text-dim); font-size: 12px; margin-top: 8px; }

        .footer { margin: 30px 0; color: rgba(255, 255, 255, 0.2); font-size: 11px; }
        .tag { background: #ffc107; color: #000; font-size: 10px; padding: 1px 4px; border-radius: 3px; margin-left: 5px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <!-- 顶部窄条 -->
    <div class="top-notice-bar copy-btn" data-clipboard-text="yxxq.site">
        点击复制并保存发布页域名：<b>yxxq.site</b> (建议按 Ctrl+D 收藏)
    </div>

    <div class="header">
        <img src="img/bea51e2dca5dd1ac3e782268ec5303cf.png" alt="Logo">
    </div>

    <!-- 永久域名卡片 -->
    <div class="permanent-card">
        <div class="hint">务必保存，永久导航域名</div>
        <div class="domain-name">yxxq.site</div>
        <button class="btn-main copy-btn" data-clipboard-text="yxxq.site">点击复制并收藏</button>
    </div>

    <!-- 域名显示区域 -->
    <div class="domain-list" id="domain-list-box">
        <div style="padding: 30px; text-align: center; color: var(--text-dim);">正在尝试建立连接...</div>
    </div>

    <div class="qr-section">
        <img src="img/qr.png" alt="QR">
        <p>扫描二维码，永久获取最新地址</p>
    </div>

    <div class="footer">©2025 映像星球. All Rights Reserved</div>
</div>

<!-- 1. 先引入域名数据 -->
<script src="js/domains.js"></script>

<script>
    // 渲染函数
    function startRender() {
        const box = document.getElementById('domain-list-box');
        // 获取数据（兼容多种读取方式）
        const list = window.domainList || (typeof domainList !== 'undefined' ? domainList : []);

        if (list.length === 0) {
            box.innerHTML = '<div style="padding:30px; color:#ff4444; text-align:center;">数据加载失败，请刷新页面</div>';
            return;
        }

        const selected = [...list].sort(() => 0.5 - Math.random()).slice(0, 6);
        box.innerHTML = ''; 

        selected.forEach((url, i) => {
            const isFirst = i === 0;
            const item = document.createElement('div');
            item.className = 'domain-item';
            item.innerHTML = `
                <div class="domain-info">
                    <div class="label">${isFirst ? '官方推荐' : '备用线路'+i}${isFirst ? '<span class="tag">极速</span>' : ''}</div>
                    <div class="url">${url}</div>
                </div>
                <div class="actions">
                    <span class="speed" id="ms-${i}">检测中</span>
                    <a href="javascript:;" class="btn-sm copy-btn" data-clipboard-text="${url}">复制</a>
                    <a href="${url}" target="_blank" class="btn-sm enter">进入</a>
                </div>
            `;
            box.appendChild(item);
            
            // 简单测速
            const sTime = Date.now();
            fetch(url, { mode: 'no-cors', cache: 'no-store' }).then(() => {
                const diff = Date.now() - sTime;
                const el = document.getElementById('ms-'+i);
                if(el) { el.textContent = diff + 'ms'; el.className = 'speed ' + (diff < 500 ? 'good' : 'bad'); }
            }).catch(() => {
                const el = document.getElementById('ms-'+i);
                if(el) { el.textContent = '稳定'; el.className = 'speed good'; }
            });
        });
    }

    // 初始化复制功能（带容错）
    function initCopy() {
        if (typeof ClipboardJS !== 'undefined') {
            const cp = new ClipboardJS('.copy-btn');
            cp.on('success', (e) => { alert('复制成功：' + e.text); e.clearSelection(); });
        } else {
            // 如果插件加载失败，使用备用原生方案
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.onclick = function() {
                    const txt = this.getAttribute('data-clipboard-text');
                    navigator.clipboard.writeText(txt).then(() => alert('复制成功：' + txt));
                };
            });
        }
    }

    // 页面完全加载后执行
    window.addEventListener('load', () => {
        startRender();
        initCopy();
    });
</script>

</body>
</html>
